<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.7.4">Jekyll</generator><link href="https://no3371.github.io/blog/feed.xml" rel="self" type="application/atom+xml" /><link href="https://no3371.github.io/blog/" rel="alternate" type="text/html" /><updated>2020-07-15T02:46:07+08:00</updated><id>https://no3371.github.io/blog/</id><title type="html">#3371</title><subtitle>Where a crazy guy talks about coding, games or boring thought.</subtitle><entry xml:lang="en"><title type="html">Create Custom World in Unity ECS</title><link href="https://no3371.github.io/blog/create-custom-world-in-unity-ecs" rel="alternate" type="text/html" title="Create Custom World in Unity ECS" /><published>2020-07-15T02:07:00+08:00</published><updated>2020-07-15T02:07:00+08:00</updated><id>https://no3371.github.io/blog/create-custom-world-in-unity-ecs</id><content type="html" xml:base="https://no3371.github.io/blog/create-custom-world-in-unity-ecs">&lt;p&gt;:::info
This article assumes you Unity ECS knowledge mentioned in the article (:door:&lt;a href=&quot;https://gametorrahod.com/world-system-groups-update-order-and-the-player-loop/&quot;&gt;link&lt;/a&gt;) (some part of it is deprecated).
:::&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-CSharp&quot;&gt;using Unity.Entities;
using UnityEngine;
using UnityEngine.LowLevel;

public class Bootstrap
{
    // It's just i want to create the world so early, it's up to you when to create the world
    [RuntimeInitializeOnLoadMethod(UnityEngine.RuntimeInitializeLoadType.BeforeSceneLoad)]
    static void CreateWorld ()
    {
        World w = new World(&quot;BootWorld&quot;);
        ScriptBehaviourUpdateOrder.UpdatePlayerLoop(w, PlayerLoop.GetCurrentPlayerLoop()); // You have to hook the world into player loop
        w.GetOrCreateSystem&amp;lt;InitializationSystemGroup&amp;gt;(); // Player loop only update these group
        w.GetOrCreateSystem&amp;lt;SimulationSystemGroup&amp;gt;();     // Player loop only update these group
        w.GetOrCreateSystem&amp;lt;PresentationSystemGroup&amp;gt;();   // Player loop only update these group
        w.GetOrCreateSystem&amp;lt;YourSystem&amp;gt;(); // Create the sytem in the world
        // We have to add the system to any of the 3 group.
        // Otherwise the system idly exist in the world, but won't do anything and won't show up in the debugger
        w.GetExistingSystem&amp;lt;InitializationSystemGroup&amp;gt;().AddSystemToUpdateList(w.GetExistingSystem&amp;lt;YourSystem&amp;gt;());
        // Now the system should be working and can query for interesting entites
    }
}

&lt;/code&gt;&lt;/pre&gt;</content><author><name>No3371</name></author><category term="Unity" /><category term="Coding" /><summary type="html">:::info This article assumes you Unity ECS knowledge mentioned in the article (:door:link) (some part of it is deprecated). :::</summary></entry><entry xml:lang="zh_TW"><title type="html">The Evolution Of Variables</title><link href="https://no3371.github.io/blog/the-evolution-of-variables-en" rel="alternate" type="text/html" title="The Evolution Of Variables" /><published>2020-07-15T02:07:00+08:00</published><updated>2020-07-15T02:07:00+08:00</updated><id>https://no3371.github.io/blog/the-evolution-of-variables-en</id><content type="html" xml:base="https://no3371.github.io/blog/the-evolution-of-variables-en">&lt;p&gt;Take a look at this equation: &lt;code class=&quot;highlighter-rouge&quot;&gt;ATK = STR * 10&lt;/code&gt;. It’s simple, isn’t it?&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ATK = (STR + DEX) * 5&lt;/code&gt; is also simple, I have no doubt you can tell me the answer in seconds when I tell you the value of STR and DEX.&lt;/p&gt;

&lt;p&gt;How about:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;DMG = (((ATK + BASE_ATK_MODIFIER) * ATK_MULTIPLIER + ATK_MODIFIER) * ATK_TO_DMG_RATIO + DMG_MODIFIER) * FINAL_DMG_MULTIPLIER&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Looks like something that you need in a RPG game with a complete sets of potions, buffs, debuffs, etc. right? You have to do something like this when you need to calculate how much damage a character can made.
Leme try to convert this to C#:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-CSharp&quot;&gt;float newDmg;
newDmg = atk + baseAtkModifier;
newDmg = newDmg * atkMultiplier + atkModifier;
newDmg = newDmg * atkToDmgRatio + dmgModifier;
newDmg *= finalDmgMultiplier; 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I have several questions for you:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;If it’s a MMO, how much calculation do you need when you have 10000 players?&lt;/li&gt;
  &lt;li&gt;When do you run this recalculation? You can cache &lt;code class=&quot;highlighter-rouge&quot;&gt;DMG&lt;/code&gt; so you will not always recalculate it, but you have to do it when any of [&lt;code class=&quot;highlighter-rouge&quot;&gt;ATK&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;BASE_ATK_MODIFIER&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;ATK_MULTIPLIER&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;ATK_MODIFIER&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;ATK_TO_DMG_RATIO&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;DMG_MODIFIER&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;FINAL_DMG_MULTIPLIER&lt;/code&gt;] is changed, right? How do you know that, these dependencies are changed so you have to recalculate?&lt;/li&gt;
  &lt;li&gt;So to know when you want to push the change to &lt;code class=&quot;highlighter-rouge&quot;&gt;ATK&lt;/code&gt;, so all values depends on it will recalculate, how do you know what values depends on it? What values to recalcualte?&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Do You write:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-CSharp&quot;&gt;atk += 10;
RecalculateDMG();
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;or&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-CSharp&quot;&gt;atkModifier += 10;
RecalculateDMG();
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;here, there, everywhere? Right, you should improve it a bit:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-CSharp&quot;&gt;void SetATK(float value)
{
  atk = value;
  RecalculateDMG();
}

void SetBaseAtkModifier(float value) {...}
void SetAtkMultiplier(float value) {...}
void SetAtkModifier(float value) {...}
void SetAtkToDmgRatio(float value) {...}
void SetDmgModifier(float value) {...}
void SetFinalDmgMultiplier(float value) {...}

void SetDMG(float value)
{
  dmg = value;
  RecalculateOtherStuffDependsOnDMG();
}

void RecalculateDMG()
{
  float newDmg;
  newDmg = atk + baseAtkModifier;
  newDmg = newDmg * atkMultiplier + atkModifier;
  newDmg = newDmg * atkToDmgRatio + dmgModifier;
  newDmg *= finalDmgMultiplier; 
  SetDMG(dmg);
}

void main ()
{
  SetATK(10);
  SetBaseAtkModifier(1); // From a passive skill: Base ATK + 1
  SetAtkMultiplier(2); // From a weapon have 200% power
  SetAtkModifier(10); // From ATK+ potion
  SetAtkToDmgRatio(1); // Default value
  SetDmgModifier(-100); // From a debuff that weakening you
  SetFinalDmgMultiplier(2); // From a game mode that everybody deals double damage
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Some more questions to bother you:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;This is a very simple system, not enough for a RPG, how many codes you’ll have to write and keep maintaining for a complex 4X e.g. Stellaris&lt;/li&gt;
  &lt;li&gt;The example is a very simple 1 level structure. What if there’re other values depends on &lt;code class=&quot;highlighter-rouge&quot;&gt;DMG&lt;/code&gt;? What if all these values &lt;code class=&quot;highlighter-rouge&quot;&gt;DMG&lt;/code&gt; depends on depends on somethings else? What if deep inside the &lt;code class=&quot;highlighter-rouge&quot;&gt;RecalculateOtherStuffDependsOnDMG()&lt;/code&gt; you unintentionally modified &lt;code class=&quot;highlighter-rouge&quot;&gt;ATK&lt;/code&gt;… you never know before you encounter StackOverflowException.&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;SetAtkToDmgRatio(1); // Default value&lt;/code&gt; does not actually change the value, but the recalculation will occurs if you do not check the equality. Do you want to add a if to before all the Set()?&lt;/li&gt;
  &lt;li&gt;All the calculation before the last Set() is wasted, you only needs the latest DMG… Do you want to come back to the old ways so:
    &lt;pre&gt;&lt;code class=&quot;language-CSharp&quot;&gt;  atk = 10;
  baseAtkModifier = 1;
  atkMultiplier = 2;
  atkModifier = 10;
  atkToDmgRatio = 1;
  dmgModifier = -100;
  finalDmgMultiplier = 2;
&lt;/code&gt;&lt;/pre&gt;
    &lt;p&gt;whenver any of the lines appears in your codebase you place a &lt;code class=&quot;highlighter-rouge&quot;&gt;RecalculateDMG();&lt;/code&gt;… Sounds cool.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;You may have realized that, in this way, the model of all these values exist in your head, or on some designer documentation, it’s all your labor to maintain the implementation of the model, any tiny change you’ll have to edit a piece of code.&lt;/p&gt;

&lt;p&gt;As a wise man once said:&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;Modern problems require modern solutions.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;It’s time to introduce a automatic system to take over the burden.&lt;/p&gt;</content><author><name>No3371</name></author><category term="Unity" /><category term="Coding" /><summary type="html">Take a look at this equation: ATK = STR * 10. It’s simple, isn’t it?</summary></entry><entry><title type="html">Welcome to Ghost</title><link href="https://no3371.github.io/blog/welcome-en" rel="alternate" type="text/html" title="Welcome to Ghost" /><published>2017-07-27T18:00:00+08:00</published><updated>2017-07-27T18:00:00+08:00</updated><id>https://no3371.github.io/blog/welcome-en</id><content type="html" xml:base="https://no3371.github.io/blog/welcome-en">&lt;p&gt;Hey! Welcome to Ghost, it’s great to have you :)&lt;/p&gt;

&lt;p&gt;We know that first impressions are important, so we’ve populated your new site with some initial &lt;strong&gt;Getting Started&lt;/strong&gt; posts that will help you get familiar with everything in no time. This is the first one!&lt;/p&gt;

&lt;h3 id=&quot;there-are-a-few-things-that-you-should-know-up-front&quot;&gt;There are a few things that you should know up-front:&lt;/h3&gt;
&lt;ol&gt;
  &lt;li&gt;Ghost is designed for ambitious, professional publishers who want to actively build a business around their content. That’s who it works best for. If you’re using Ghost for some other purpose, that’s fine too - but it might not be the best choice for you.&lt;/li&gt;
  &lt;li&gt;The entire platform can be modified and customized to suit your needs, which is very powerful, but doing so &lt;strong&gt;does&lt;/strong&gt; require some knowledge of code. Ghost is not necessarily a good platform for beginners or people who just want a simple personal blog.&lt;/li&gt;
  &lt;li&gt;For the best experience we recommend downloading the Ghost Desktop App for your computer, which is the best way to access your Ghost site on a desktop device.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Ghost is made by an independent non-profit organisation called the Ghost Foundation. We are 100% self funded by revenue from our &lt;a href=&quot;https://ghost.org/pricing&quot;&gt;Ghost(Pro)&lt;/a&gt; service, and every penny we make is re-invested into funding further development of free, open source technology for modern journalism.&lt;/p&gt;

&lt;p&gt;The main thing you’ll want to read about next is probably: &lt;a href=&quot;https://demo.ghost.io/the-editor/&quot;&gt;the Ghost editor&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Once you’re done reading, you can simply delete the default &lt;strong&gt;Ghost&lt;/strong&gt; user from your team to remove all of these introductory posts!&lt;/p&gt;</content><author><name>ghost</name></author><category term="Getting started" /><summary type="html">Hey! Welcome to Ghost, it’s great to have you :)</summary></entry><entry><title type="html">Out to Sea</title><link href="https://no3371.github.io/blog/out-to-sea" rel="alternate" type="text/html" title="Out to Sea" /><published>1912-07-24T18:18:00+08:00</published><updated>1912-07-24T18:18:00+08:00</updated><id>https://no3371.github.io/blog/out-to-sea</id><content type="html" xml:base="https://no3371.github.io/blog/out-to-sea">&lt;p&gt;I had this story from one who had no business to tell it to me, or to any other. I may credit the seductive influence of an old vintage upon the narrator for the beginning of it, and my own skeptical incredulity during the days that followed for the balance of the strange tale.&lt;/p&gt;

&lt;p&gt;When my convivial host discovered that he had told me so much, and that I was prone to doubtfulness, his foolish pride assumed the task the old vintage had commenced, and so he unearthed written evidence in the form of musty manuscript, and dry official records of the British Colonial Office to support many of the salient features of his remarkable narrative.&lt;/p&gt;

&lt;p&gt;I do not say the story is true, for I did not witness the happenings which it portrays, but the fact that in the telling of it to you I have taken fictitious names for the principal characters quite sufficiently evidences the sincerity of my own belief that it MAY be true.&lt;/p&gt;

&lt;p&gt;The yellow, mildewed pages of the diary of a man long dead, and the records of the Colonial Office dovetail perfectly with the narrative of my convivial host, and so I give you the story as I painstakingly pieced it out from these several various agencies.&lt;/p&gt;

&lt;p&gt;If you do not find it credible you will at least be as one with me in acknowledging that it is unique, remarkable, and interesting.&lt;/p&gt;

&lt;p&gt;From the records of the Colonial Office and from the dead man’s diary we learn that a certain young English nobleman, whom we shall call John Clayton, Lord Greystoke, was commissioned to make a peculiarly delicate investigation of conditions in a British West Coast African Colony from whose simple native inhabitants another European power was known to be recruiting soldiers for its native army, which it used solely for the forcible collection of rubber and ivory from the savage tribes along the Congo and the Aruwimi. The natives of the British Colony complained that many of their young men were enticed away through the medium of fair and glowing promises, but that few if any ever returned to their families.&lt;/p&gt;

&lt;p&gt;The Englishmen in Africa went even further, saying that these poor blacks were held in virtual slavery, since after their terms of enlistment expired their ignorance was imposed upon by their white officers, and they were told that they had yet several years to serve.&lt;/p&gt;

&lt;p&gt;And so the Colonial Office appointed John Clayton to a new post in British West Africa, but his confidential instructions centered on a thorough investigation of the unfair treatment of black British subjects by the officers of a friendly European power. Why he was sent, is, however, of little moment to this story, for he never made an investigation, nor, in fact, did he ever reach his destination.&lt;/p&gt;

&lt;p&gt;Clayton was the type of Englishman that one likes best to associate with the noblest monuments of historic achievement upon a thousand victorious battlefields–a strong, virile man –mentally, morally, and physically.&lt;/p&gt;

&lt;p&gt;In stature he was above the average height; his eyes were gray, his features regular and strong; his carriage that of perfect, robust health influenced by his years of army training.&lt;/p&gt;

&lt;p&gt;Political ambition had caused him to seek transference from the army to the Colonial Office and so we find him, still young, entrusted with a delicate and important commission in the service of the Queen.&lt;/p&gt;

&lt;p&gt;When he received this appointment he was both elated and appalled. The preferment seemed to him in the nature of a well-merited reward for painstaking and intelligent service, and as a stepping stone to posts of greater importance and responsibility; but, on the other hand, he had been married to the Hon. Alice Rutherford for scarce a three months, and it was the thought of taking this fair young girl into the dangers and isolation of tropical Africa that appalled him.&lt;/p&gt;

&lt;p&gt;For her sake he would have refused the appointment, but she would not have it so. Instead she insisted that he accept, and, indeed, take her with him.&lt;/p&gt;

&lt;p&gt;There were mothers and brothers and sisters, and aunts and cousins to express various opinions on the subject, but as to what they severally advised history is silent.&lt;/p&gt;

&lt;p&gt;We know only that on a bright May morning in 1888, John, Lord Greystoke, and Lady Alice sailed from Dover on their way to Africa.&lt;/p&gt;

&lt;p&gt;A month later they arrived at Freetown where they chartered a small sailing vessel, the Fuwalda, which was to bear them to their final destination.&lt;/p&gt;

&lt;p&gt;And here John, Lord Greystoke, and Lady Alice, his wife, vanished from the eyes and from the knowledge of men.&lt;/p&gt;

&lt;p&gt;Two months after they weighed anchor and cleared from the port of Freetown a half dozen British war vessels were scouring the south Atlantic for trace of them or their little vessel, and it was almost immediately that the wreckage was found upon the shores of St. Helena which convinced the world that the Fuwalda had gone down with all on board, and hence the search was stopped ere it had scarce begun; though hope lingered in longing hearts for many years.&lt;/p&gt;

&lt;p&gt;The Fuwalda, a barkentine of about one hundred tons, was a vessel of the type often seen in coastwise trade in the far southern Atlantic, their crews composed of the offscourings of the sea–unhanged murderers and cutthroats of every race and every nation.&lt;/p&gt;

&lt;p&gt;The Fuwalda was no exception to the rule. Her officers were swarthy bullies, hating and hated by their crew. The captain, while a competent seaman, was a brute in his treatment of his men. He knew, or at least he used, but two arguments in his dealings with them–a belaying pin and a revolver–nor is it likely that the motley aggregation he signed would have understood aught else.&lt;/p&gt;

&lt;p&gt;So it was that from the second day out from Freetown John Clayton and his young wife witnessed scenes upon the deck of the Fuwalda such as they had believed were never enacted outside the covers of printed stories of the sea.&lt;/p&gt;

&lt;p&gt;It was on the morning of the second day that the first link was forged in what was destined to form a chain of circumstances ending in a life for one then unborn such as has never been paralleled in the history of man.&lt;/p&gt;

&lt;p&gt;Two sailors were washing down the decks of the Fuwalda, the first mate was on duty, and the captain had stopped to speak with John Clayton and Lady Alice.&lt;/p&gt;

&lt;p&gt;The men were working backwards toward the little party who were facing away from the sailors. Closer and closer they came, until one of them was directly behind the captain. In another moment he would have passed by and this strange narrative would never have been recorded.&lt;/p&gt;

&lt;p&gt;But just that instant the officer turned to leave Lord and Lady Greystoke, and, as he did so, tripped against the sailor and sprawled headlong upon the deck, overturning the water- pail so that he was drenched in its dirty contents.&lt;/p&gt;

&lt;p&gt;For an instant the scene was ludicrous; but only for an instant. With a volley of awful oaths, his face suffused with the scarlet of mortification and rage, the captain regained his feet, and with a terrific blow felled the sailor to the deck.&lt;/p&gt;

&lt;p&gt;The man was small and rather old, so that the brutality of the act was thus accentuated. The other seaman, however, was neither old nor small–a huge bear of a man, with fierce black mustachios, and a great bull neck set between massive shoulders.&lt;/p&gt;

&lt;p&gt;As he saw his mate go down he crouched, and, with a low snarl, sprang upon the captain crushing him to his knees with a single mighty blow.&lt;/p&gt;

&lt;p&gt;From scarlet the officer’s face went white, for this was mutiny; and mutiny he had met and subdued before in his brutal career. Without waiting to rise he whipped a revolver from his pocket, firing point blank at the great mountain of muscle towering before him; but, quick as he was, John Clayton was almost as quick, so that the bullet which was intended for the sailor’s heart lodged in the sailor’s leg instead, for Lord Greystoke had struck down the captain’s arm as he had seen the weapon flash in the sun.&lt;/p&gt;

&lt;p&gt;Words passed between Clayton and the captain, the former making it plain that he was disgusted with the brutality displayed toward the crew, nor would he countenance anything further of the kind while he and Lady Greystoke remained passengers.&lt;/p&gt;

&lt;p&gt;The captain was on the point of making an angry reply, but, thinking better of it, turned on his heel and black and scowling, strode aft.&lt;/p&gt;

&lt;p&gt;He did not care to antagonize an English official, for the Queen’s mighty arm wielded a punitive instrument which he could appreciate, and which he feared–England’s far-reaching navy.&lt;/p&gt;

&lt;p&gt;The two sailors picked themselves up, the older man assisting his wounded comrade to rise. The big fellow, who was known among his mates as Black Michael, tried his leg gingerly, and, finding that it bore his weight, turned to Clayton with a word of gruff thanks.&lt;/p&gt;

&lt;p&gt;Though the fellow’s tone was surly, his words were evidently well meant. Ere he had scarce finished his little speech he had turned and was limping off toward the forecastle with the very apparent intention of forestalling any further conversation.&lt;/p&gt;

&lt;p&gt;They did not see him again for several days, nor did the captain accord them more than the surliest of grunts when he was forced to speak to them.&lt;/p&gt;

&lt;p&gt;They took their meals in his cabin, as they had before the unfortunate occurrence; but the captain was careful to see that his duties never permitted him to eat at the same time.&lt;/p&gt;

&lt;p&gt;The other officers were coarse, illiterate fellows, but little above the villainous crew they bullied, and were only too glad to avoid social intercourse with the polished English noble and his lady, so that the Claytons were left very much to themselves.&lt;/p&gt;

&lt;p&gt;This in itself accorded perfectly with their desires, but it also rather isolated them from the life of the little ship so that they were unable to keep in touch with the daily happenings which were to culminate so soon in bloody tragedy.&lt;/p&gt;</content><author><name>edgar</name></author><category term="fiction" /><summary type="html">I had this story from one who had no business to tell it to me, or to any other. I may credit the seductive influence of an old vintage upon the narrator for the beginning of it, and my own skeptical incredulity during the days that followed for the balance of the strange tale.</summary></entry></feed>